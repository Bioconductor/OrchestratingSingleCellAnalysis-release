


```r
library(scRNAseq)
sce.lawlor <- LawlorPancreasData()
```


```r
library(AnnotationHub)
edb <- AnnotationHub()[["AH73881"]]
anno <- select(edb, keys=rownames(sce.lawlor), keytype="GENEID", 
    columns=c("SYMBOL", "SEQNAME"))
rowData(sce.lawlor) <- anno[match(rownames(sce.lawlor), anno[,1]),-1]
```


```r
library(scater)
qcstats <- perCellQCMetrics(sce.lawlor, 
    subsets=list(Mito=which(rowData(sce.lawlor)$SEQNAME=="MT")))
filtered <- quickCellQC(qcstats, percent_subsets="subsets_Mito_percent", nmads=3)
sce.lawlor <- sce.lawlor[,!filtered$discard]
```


```r
library(scran)
set.seed(1000)
clusters <- quickCluster(sce.lawlor)
sce.lawlor <- computeSumFactors(sce.lawlor, clusters=clusters)
sce.lawlor <- normalize(sce.lawlor)
```


```r
dec.lawlor <- modelGeneVar(sce.lawlor, block=sce.lawlor$Donor)
```
